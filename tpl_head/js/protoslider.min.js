/**
 * @package        Protoslider
 * @version        1.0.7
 * 
 * @author         Carsten Ruppert <ca.ru@posteo.de>
 * @link           
 * @copyright      Copyright Â© 2018 Carsten Ruppert All Rights Reserved
 * @license        http://www.gnu.org/licenses/gpl-2.0.html GNU/GPL
 */

(function(d){d.Protoslider=function(a,b){this.$node=d(b);if(!this.$node.length)return console.log("Kein node"),!1;this.$node.data("ptslider",this);this.$wrap=this.$node.children(".ptslider-wrapper");this._init(a);return this};d.Protoslider.Plugins=[];d.Protoslider.defaults={autoheight:!0,preload:!0,loadingIndicator:!0,size:[1200,979,767,0],items:[1,1,1,1],autoplay:!0,loop:!0,randomstart:!1,timeout:5E3,delaystart:0,direction:"forwards",pauseonhover:!0,onlyInViewport:!0,pagination:!0,paginationLabels:!0,
navigation:!0,swipe:!0,swipeThreshold:80,pauseonswipe:!0,swipepause:2E4,plugins:[],zAxis:{pagination:2,navigation:1},delay:0,animations:{autoplay:{"in":"fadeIn",out:"fadeOut",duration:"1s",random:!0,delay:0},pagination:{"in":"fadeIn",out:"fadeOut",duration:"1s",delay:0},navigation:{nextIn:"slideInRight",nextOut:"slideOutLeft",prevIn:"slideInLeft",prevOut:"slideOutRight",duration:"0.75s",delay:0},swipe:{nextIn:"slideInRight",nextOut:"slideOutLeft",prevIn:"slideInLeft",prevOut:"slideOutRight",duration:"0.3s",
delay:0}},html:{btnPrev:'<span class="ptslider-nav ptslider-nav-prev" />',btnNext:'<span class="ptslider-nav ptslider-nav-next" />',pagination:'<div class="ptslider-pagination" />',pager:'<span class="ptslider-pager" />',pagerLabel:'<span class="ptslider-pager-label">%s</span>',loading:'<div class="ptslider-preload"><div class="ptslider-indicator"><div class="spinner"><div class="dot1"></div><div class="dot2"></div></div><span class="percent-loaded"></span></div></div>'},css:{classActive:"ptin",labeledPager:"labeled",
classAnimated:"animated",classInfinite:"infinite",styleActive:{visibility:"visible",position:"absolute"},styleInactive:{visibility:"hidden",position:"absolute"}},eventNamespace:".ptslider",bulkEvents:{resize:"resize",orientationchange:"orientationchange"},vendorEvents:{animation:{animationEnd:"animationend",animationIteration:"animationiteration",transitionEnd:"transitionend"},webkitAnimation:{animationEnd:"webkitAnimationEnd",animationIteration:"webkitAnimationIteration",transitionEnd:"webkitTransitionEnd"},
oAnimation:{animationEnd:"oanimationend",animationIteration:"oanimationiteration",transitionEnd:"otransitionend"}},onBeforeAnimation:!1,onBeginAnimation:!1,onAfterAnimation:!1,onBeginSlideAnimation:!1,onAfterSlideAnimation:!1,onPause:!1,onPlay:!1,onInit:!1,onAfterInit:!1,onAfterImagePreload:!1};d.Protoslider.prototype={_init:function(a){this.options=d.extend(!0,{},d.Protoslider.defaults,a);this.$node.data("ptoptions")&&d.extend(!0,this.options,this.$node.data("ptoptions"));this.State={ready:!1,isIdle:!1,
trigger:{},rows:0,row:0,rowNext:0,columns:this.options.items[0],stage:[],touch:{}};this.getVendorEvents();this.Controls={pagination:!1,prev:!1,next:!1,swipe:!1};this.Preload={entities:!1,loaded:0};this.playtimer=void 0;this.$slides=this.$node.find(".ptslider-item");if(!this.$slides.length)return console&&console.log("Protoslider hat keine Slides in #"+this.$node.attr("id")+" ("+this.$node.attr("class")+")"),!1;"function"===typeof this.options.onInit&&this.options.onInit.apply(this);this.options.plugins=
this.options.plugins.concat(d.Protoslider.Plugins);this.options.plugins=this.options.plugins.filter(function(a,b,d){return d.indexOf(a)===b});if(0<this.options.plugins.length){a=0;for(var b=this.options.plugins.length;a<b;a++)this[this.options.plugins[a]]=new d[this.options.plugins[a]](this);"function"===typeof this.options.onAfterInitPlugins&&this.options.onAfterInitPlugins.apply(this)}this.options.preload?this._preload():this._setup()},on:function(){for(var a in arguments)"function"===typeof arguments[a]&&
(arguments[a]=d.proxy(arguments[a],this));a=Array.prototype.slice.call(arguments);this.$node.on.apply(this.$node,a);return this},one:function(){for(var a in arguments)"function"===typeof arguments[a]&&(arguments[a]=d.proxy(arguments[a],this));a=Array.prototype.slice.call(arguments);this.$node.one.apply(this.$node,a);return this},off:function(){var a=Array.prototype.slice.call(arguments);this.$node.off.apply(this.$node,a);return this},getViewportSize:function(){var a=window,b=document.documentElement,
c=document.getElementsByTagName("body")[0];return{w:a.innerWidth||b.clientWidth||c.clientWidth,h:a.innerHeight||b.clientHeight||c.clientHeight}},isInViewport:function(){var a=this.getViewportSize(),b=d(document).scrollTop();return a.h+b>=this.$node.offset().top&&this.$node.offset().top+this.$node.height()>b?!0:!1},getVendorEvents:function(){for(var a in this.options.vendorEvents)if(this.options.vendorEvents.hasOwnProperty(a)&&void 0!==this.$node.get(0).style[a]){this.State.events=this.options.vendorEvents[a];
d.extend(this.State.events,this.options.bulkEvents);for(var b in this.State.events)this.State.events.hasOwnProperty(b)&&(this.State.events[b]+=this.options.eventNamespace);break}},_preload:function(){this.Preload.entities=this.$wrap.find("img");if(0<this.Preload.entities.length){var a=this;this.options.loadingIndicator&&this.showIndicator();for(var b=0,c=this.Preload.entities.length;b<c;b++)if(-1<window.navigator.userAgent.indexOf("MSIE ")&&this.Preload.entities.eq(b-1).attr("src",this.Preload.entities.eq(b-
1).attr("src")),this.Preload.entities.get(b-1).complete)this.Preload.entities.eq(b-1).one("load"+this.options.eventNamespace,function(){++a.Preload.loaded;a._entityLoaded()}),++this.Preload.loaded,this._entityLoaded();else this.Preload.entities.eq(b-1).one("load"+this.options.eventNamespace,function(){++a.Preload.loaded;a._entityLoaded()})}else this._onAfterPreload()},_entityLoaded:function(){this.options.loadingIndicator&&this.updateIndicator();this.Preload.loaded==this.Preload.entities.length&&
this._onAfterPreload()},_onAfterPreload:function(){this.options.loadingIndicator&&this.hideIndicator();"function"===typeof this.options.onAfterImagePreload&&this.options.onAfterImagePreload.apply(this);this._setup()},showIndicator:function(){this.$indicator||(this.$indicator=d(this.options.html.loading),this.$indicator.find(".percent-loaded").append("0%"),this.$wrap.append(this.$indicator));this.$indicator.addClass("visible")},updateIndicator:function(){var a=this.$indicator.find(".percent-loaded"),
b=Math.round(this.Preload.loaded/this.Preload.entities.length*100+.4);b=100<b?100:b;a.off(this.State.events.transitionEnd).on(this.State.events.transitionEnd,function(){a.removeClass("updated")});a.addClass("updated").html(b+"%")},hideIndicator:function(){this.$indicator&&this.$indicator.removeClass("visible")},_setup:function(){if(this.State.ready)console&&console.log("Protoslider ist bereit, wollte _setup aber erneut ausf\u00fchren!");else{for(var a={ptslider:this},b=0,c=this.$slides.length;b<c;b++)this.$slides.eq(b).data("ptslider",
a);d.fn._ptsSetAnimation||d.fn._ptsClearAnimation||this.installAnimationHelpers();if(this.render()){this.observeViewport();if(this.options.autoplay)if(this.options.pauseonhover&&this.setPauseEvents(),0<this.options.delaystart){var e=this;this.State.starttimer=window.setTimeout(function(){e.play()},this.options.delaystart)}else this.play();this._onAfterSetup()}else console&&console.log("Protoslider Rendern fehlgeschlagen!")}},_onAfterSetup:function(){this.State.ready=!0;this.$node.addClass("ptready");
this.$node.triggerHandler("sliderReady");"function"===typeof this.options.onAfterInit&&this.options.onAfterInit.apply(this)},installAnimationHelpers:function(){d.fn._ptsSetAnimation=function(a,b,c){var e=d(this),f=e.data("ptslider")||{};if(f.ptslider){e.addClass(f.ptslider.options.css.classAnimated);f.ac=0;f.anims=[];e.addClass(a+(b?" "+f.ptslider.options.css.classInfinite:""));++f.ac;if(b)"function"===typeof c&&c.apply(this);else e.one(f.ptslider.State.events.animationEnd,function(){d(this)._ptsClearAnimation(a)});
f.anims[f.ac]={name:a,loop:b};e.data("ptslider",d.extend(e.data("ptslider"),f));return this}};d.fn._ptsClearAnimation=function(a,b){var c=d(this),e=c.data("ptslider");c.removeClass(a+(b?" "+e.ptslider.options.css.classInfinite:""));0<e.ac&&--e.ac;e.ac||c.removeClass(e.ptslider.options.css.classAnimated);c.data("ptslider",d.extend(c.data("ptslider"),e));return this};d.fn._ptsClearAllAnimations=function(){var a=d(this),b=a.data("ptslider");if(a&&b&&(a.off(b.ptslider.options.eventNamespace),b.anims))for(var c=
0,e=b.anims.length;c<e;c++)b.anims[c]&&a._ptsClearAnimation(b.anims[c].name,b.anims[c].loop)}},getRandomRow:function(){return Math.floor(Math.random()*this.map.length)},destroy:function(){this.clearAutoplayTimeout();this.clearSlideAnimations();this.options.pauseonhover&&this.unsetPauseEvents();this.options.pagination&&this.removePagination();this.options.navigation&&this.removeNavigation();this.$slides.each(function(){$slide=d(this);$slide.removeData("ptslider")});this.$node.removeData("ptslider")},
setPauseEvents:function(){var a=this;this.$node.on("mouseover"+this.options.eventNamespace,function(){a.State.paused||(a.pause(),a.$node.one("mouseout"+a.options.eventNamespace,function(){a.play()}))})},unsetPauseEvents:function(){this.$node.off("mouseover"+this.options.eventNamespace);this.$node.off("mouseout"+this.options.eventNamespace)},getSliderColumns:function(){for(var a=this.getViewportSize().w,b=0,c=this.options.size.length;b<c;b++){if(a<this.options.size[b]&&a>=this.options.size[b+1])return this.options.items[b+
1];if(a>=this.options.size[b])return this.options.items[b]}return this.State.columns},getSliderRows:function(){return Math.round(this.$slides.length/this.State.columns+.4)},getSliderMap:function(){for(var a=[],b=0,c=this.State.rows;b<c;b++){a[b]=[];for(var e=0,d=this.State.columns;e<d;e++){var g=this.$slides.eq(b*this.State.columns+e);a[b][e]=g}}return a},prepareSlidesOnStage:function(){for(var a=0,b=this.map.length;a<b;a++)for(var c=0,e=this.map[a].length;c<e;c++){var d=this.map[a][c];d.data("ptslider");
d.css({zIndex:this.State.rows-a,width:100/this.State.columns+"%",left:100/this.State.columns*c+"%"});a==this.State.row?(this.State.stage[c]=d,d.addClass(this.options.css.classActive).css(this.options.css.styleActive)):d.removeClass(this.options.css.classActive).css(this.options.css.styleInactive)}},render:function(){this.clearAutoplayTimeout();this.clearSlideAnimations();var a=this.getSliderColumns();this.State.columns!=a&&(this.State.columns=a);this.State.rows=this.getSliderRows();0<this.State.columns&&
(this.map=this.getSliderMap());return this.map?(this.State.row=this.options.randomstart?this.getRandomRow():0,this.prepareSlidesOnStage(),!this.options.navigation||this.Controls.next||this.Controls.prev||this.addNavigation(),this.options.pagination&&this.addPagination(),this.options.swipe&&!this.Controls.swipe&&this.addSwipe(),this.options.autoheight&&(this.autoHeight(),this.$node.addClass("autoheight")),this.State.isIdle=!1,this.$node.triggerHandler("afterRender"),!0):!1},observeViewport:function(){var a=
this;d(window).one(this.State.events.resize,function(){a.options.autoplay&&a.pause();a.getSliderColumns()!=a.State.columns?a.render()&&a.options.autoplay&&a.play():(a.options.autoheight&&a.autoHeight(),a.options.autoplay&&a.play());a.$node.triggerHandler("resize");a.observeViewport()})},autoHeight:function(a){a=void 0===a?this.State.row:a;for(var b=0,c,e=0;e<this.map[a].length;e++)c=this.map[a][e],0===b?b=c.outerHeight():b<c.outerHeight()&&(b=c.outerHeight()),this.$wrap.height()!=b&&0<b&&this.$wrap.height(Math.round(b))},
clearSlideAnimations:function(){for(var a=0,b=this.$slides.length;a<b;a++)this.$slides.eq(a)._ptsClearAllAnimations()},addNavigation:function(){if(1!=this.$slides.length){var a=this,b=[],c=["prev","next"],e={zIndex:this.$slides.length+this.options.zAxis.navigation};b[0]=d(this.options.html.btnPrev).css(e);b[1]=d(this.options.html.btnNext).css(e);d.each(b,function(b,e){e.on("click"+a.options.eventNamespace,function(){a.State.isIdle||(a.State.trigger={name:"navigation",direction:c[b]},a.navigate(c[b]))});
a.$node.append(e)});this.Controls.prev=b[0];this.Controls.next=b[1]}},removeNavigation:function(){this.Controls.prev&&this.Controls.next&&(this.Controls.prev.remove(),this.Controls.prev=!1,this.Controls.next.remove(),this.Controls.next=!1)},addPagination:function(){if(1!=this.$slides.length){var a=this;this.$pagination&&this.removePagination();this.$pagination=d(this.options.html.pagination).css({zIndex:this.$slides.length+this.options.zAxis.pagination});for(var b=0,c=this.map.length;b<c;b++){var e=
d(this.options.html.pager);e.data("ptslider",{targetRow:b}).addClass("target-row"+b);if(this.options.paginationLabels){for(var f="",g=0,k=this.map[b].length;g<k;g++)if(this.map[b]){var h=this.map[b][g].data("ptoptions")||{};h.label&&(f+=this.options.html.pagerLabel.replace("%s",h.label),e.addClass(this.options.css.labeledPager))}e.append(f)}b==this.State.row&&e.addClass("current");e.on("click"+this.options.eventNamespace,function(){var b=d(this).data("ptslider").targetRow;b==a.State.row||a.State.isIdle||
(a.State.trigger={name:"pagination",direction:b},a.navigate(b))});this.$pagination.append(e)}this.$node.append(this.$pagination);this.Controls.pagination=!0}},removePagination:function(){this.$pagination&&this.$pagination.remove();this.Controls.pagination=!1},updatePagination:function(a){this.Controls.pagination&&(void 0===a&&(a=this.State.row),this.$pagination.find(".current").removeClass("current"),this.$pagination.children().eq(a).addClass("current"))},addSwipe:function(){var a=this;this.on("touchstart"+
this.options.eventNamespace,function(a){this.State.touch.start=parseInt(a.originalEvent.changedTouches[0].clientX);1==this.options.pauseonswipe&&1==this.options.autoplay&&this.pause()});this.on("touchmove"+this.options.eventNamespace,function(a){this.State.trigger.name="swipe";a=parseInt(a.originalEvent.changedTouches[0].clientX)-this.State.touch.start;a>this.options.swipeThreshold?(this.State.trigger.direction="prev",this.navigate("prev")):a<-this.options.swipeThreshold&&(this.State.trigger.direction=
"next",this.navigate("next"))});this.$wrap.on("touchend"+this.options.eventNamespace,function(){a.on("afterRowChange",function(a,c){1==this.options.pauseonswipe&&1==this.State.paused&&0<this.options.swipepause&&this.play(this.options.swipepause)})});this.Controls.swipe=!0},removeSwipe:function(){this.$wrap.off("touchstart"+this.options.eventNamespace);this.$wrap.off("touchmove"+this.options.eventNamespace);this.Controls.swipe=!1},prepareSlideAnimation:function(a){var b=a.data("ptslider")||{},c=a.data("ptoptions")||
{},e={};c=c.animations?d.extend(!0,{},this.options.animations,c.animations):this.options.animations;this.State.trigger.name||(this.State.trigger={name:"",direction:""});switch(this.State.trigger.name){case "navigation":switch(this.State.trigger.direction){case "next":e={animationIn:c.navigation.nextIn,animationOut:c.navigation.nextOut,duration:c.navigation.duration};break;case "prev":e={animationIn:c.navigation.prevIn,animationOut:c.navigation.prevOut,duration:c.navigation.duration}}break;case "swipe":switch(this.State.trigger.direction){case "next":e=
{animationIn:c.swipe.nextIn,animationOut:c.swipe.nextOut,duration:c.swipe.duration};break;case "prev":e={animationIn:c.swipe.prevIn,animationOut:c.swipe.prevOut,duration:c.swipe.duration}}break;case "pagination":e={animationIn:c.pagination["in"],animationOut:c.pagination.out,duration:c.pagination.duration};break;default:e=c.autoplay["in"];var f=c.autoplay.out;c.autoplay.random&&"object"===typeof e&&"object"===typeof f&&(e=e[Math.floor(Math.random()*e.length)],f=f[Math.floor(Math.random()*f.length)]);
e={animationIn:e,animationOut:f,duration:c.autoplay.duration}}a.data("ptslider",d.extend(!0,b,e))},animateSlide:function(a,b,c){var e=this;this.prepareSlideAnimation(a);a.data("ptslider");switch(b){case "in":var f={direction:"in",animation:a.data("ptslider").animationIn,eventBefore:"beforeSlideIn",eventAfter:"afterSlideIn",cssClass:this.options.css.classActive,cssInline:this.options.css.styleActive,callback:c};break;case "out":f={direction:"out",animation:a.data("ptslider").animationOut,eventBefore:"beforeSlideOut",
eventAfter:"afterSlideOut",cssClass:this.options.css.classInactive,cssInline:this.options.css.styleInactive,callback:c}}"function"===typeof e.options.onBeginSlideAnimation&&e.options.onBeginSlideAnimation.apply(a);this.$node.triggerHandler(f.eventBefore,[{slide:a}]);a.one(this.State.events.animationEnd,function(a,b){a.css(f.cssInline);"in"==this.direction?a.addClass(e.options.css.classActive):a.removeClass(e.options.css.classActive);"function"===typeof f.callback&&f.callback();"function"===typeof e.options.onAfterSlideAnimation&&
e.options.onAfterSlideAnimation.apply(a);e.$node.triggerHandler(f.eventAfter,[{slide:a}]);a.triggerHandler(f.eventAfter)}.bind(f,a)).css(d.extend(this.options.css.styleActive,{"-webkit-animation-duration":a.data("ptslider").duration,"animation-duration":a.data("ptslider").duration}))._ptsSetAnimation(f.animation)},changeColumn:function(a){var b=this,c=!1,e=this.State.stage[a],d=this.map[this.State.rowNext][a];if(d.get(0)&&d!==e){var g=0==this.State.rowNext?1:this.map.length-this.State.rowNext;a+1==
this.map[this.State.rowNext].length&&(c=!0);e.css({zIndex:g});d.css({zIndex:b.map.length});this.animateSlide(e,"out");c?this.animateSlide(d,"in",function(){b._onAfterRowChange()}):this.animateSlide(d,"in");this.State.stage[a]=d;c||this.changeRow(a+1)}else b._onAfterRowChange()},changeRow:function(a){this._onRowChange();a||(a=0);var b=this.options.animations[this.State.trigger.name].delay;if(0<a&&0<b&&1<this.State.columns){var c=this;window.setTimeout(function(){c.changeColumn(a)},b)}else this.changeColumn(a)},
_onRowChange:function(){this.State.isIdle=!0;this.options.autoheight&&this.autoHeight(this.State.rowNext);"function"===typeof this.options.onBeginAnimation&&this.options.onBeginAnimation.apply(this);this.$node.triggerHandler("rowChange",[{row:this.State.rowNext}]);this.options.pagination&&this.updatePagination(this.State.rowNext)},_onAfterRowChange:function(){this.State.row=this.State.rowNext;this.State.isIdle=!1;this.options.autoplay&&!this.State.paused&&this.play();"function"===typeof this.options.onAfterAnimation&&
this.options.onAfterAnimation.apply(this);this.$node.triggerHandler("afterRowChange",[{row:this.State.row}])},getNavDirection:function(){switch(this.options.direction){case "forwards":var a="next";break;case "backwards":a="prev";break;case "random":do a=Math.floor(Math.random()*this.map.length);while(a==this.State.row);break;default:a="next"}return a},navigate:function(a){if(!this.State.isIdle){this.clearAutoplayTimeout();switch(a){case "next":this.State.rowNext=this.State.row+1<this.map.length?this.State.row+
1:0;break;case "prev":this.State.rowNext=0>this.State.row-1?this.map.length-1:this.State.row-1;break;default:isNaN(a)||a==this.State.row||(this.State.rowNext=0<a&&a<this.map.length?a:0)}"function"===typeof this.options.onBeforeAnimation&&this.options.onBeforeAnimation.apply(this);this.changeRow()}},clearAutoplayTimeout:function(){window.clearTimeout(this.State.playtimer)},clearDelayedStart:function(){window.clearTimeout(this.State.starttimer)},play:function(a){this.clearAutoplayTimeout();if(!this.options.loop&&
this.State.row+1==this.State.rows||2>this.$slides.length)this.pause();else{this.State.paused=!1;var b=this;a=isNaN(parseInt(a))?this.options.timeout:a;this.State.playtimer=window.setTimeout(function(){b.run()},a);"function"===typeof this.options.onPlay&&this.options.onPlay.apply(this);this.$node.triggerHandler("play")}},run:function(){if(this.options.onlyInViewport&&!this.isInViewport())this.play();else{var a=this.getNavDirection();this.State.trigger={name:"autoplay",direction:a};this.navigate(a)}},
pause:function(){this.clearAutoplayTimeout();this.State.starttimer&&this.clearDelayedStart();this.State.paused=!0;"function"===typeof this.options.onPause&&this.options.onPause.apply(this);this.$node.triggerHandler("pause")}};d.fn.protoslider=function(a){var b=d(this).data("ptslider");void 0===b&&(b=new d.Protoslider(a,this));return b}})(jQuery);"use strict";
(function(d){d.Protoslider.Plugins.push("ProtosliderHtml5video");d.Protoslider.defaults.html5video={pauseOnPlay:!0,autoplay:!1,timeoutAfterPlayback:100};d.ProtosliderHtml5video=function(a){this.parent=a;this._init()};d.ProtosliderHtml5video.prototype={_init:function(){this.parent.on("beforeSlideIn.ptslider.html5video sliderReady.ptslider.html5video",function(a,b){this.tick(b)}.bind(this))},tick:function(a){a=a?a.slide:this.parent.State.stage[0];var b=this.getVideoObject(a);if(b)if(2<=b.readyState)this.playVideo(a),
this.parent.options.autoheight&&this.parent.autoHeight();else d(b).one("canplay.ptslider.html5video",function(a,b){this.playVideo(a);this.parent.options.autoheight&&this.parent.autoHeight()}.bind(this,a))},getVideoObject:function(a){a=a.find("video");return a.length?a.get(0):!1},playVideo:function(a){var b=this.getVideoObject(a);if(b){var c=d(b).data("ptoptions")||{};if(!b.hasAttribute("loop"))a.one("afterSlideOut.ptslider.html5video",function(a){if(a=this.getVideoObject(d(a.target)))a.pause(),a.currentTime=
0,d(a).off(".ptslider.html5video"),this.parent.options.autoplay&&this.parent.options.html5video.pauseOnPlay&&this.parent.play()}.bind(this));if(this.parent.options.html5video.autoplay||c.autoplay)this.parent.options.html5video.pauseOnPlay&&this.parent.options.autoplay&&(d(b).one("ended.ptslider.html5video",function(){this.parent.play(this.parent.options.html5video.timeoutAfterPlayback)}.bind(this)),this.parent.pause()),b.play()}}}})(jQuery);